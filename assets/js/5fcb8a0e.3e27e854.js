"use strict";(self.webpackChunkspencer_github_io=self.webpackChunkspencer_github_io||[]).push([[221],{181:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});var i=s(8990),t=s(4848),l=s(8453);const a={slug:"dcu-automation-ninjaone",title:"Streamlining Dell Updates with NinjaOne: A PowerShell Solution",authors:"sheath",tags:["powershell","ninjaone","dell","automation","system-management"],date:new Date("2025-03-10T00:00:00.000Z")},r=void 0,o={authorsImageUrls:[void 0]},d=[{value:"Automating Dell System Updates",id:"automating-dell-system-updates",level:2},{value:"Purpose and Features",id:"purpose-and-features",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Technical Overview",id:"technical-overview",level:3},{value:"Benefits",id:"benefits",level:3},{value:"Deployment Steps",id:"deployment-steps",level:3},{value:"Notes and Disclaimer",id:"notes-and-disclaimer",level:3},{value:"Feedback Welcome",id:"feedback-welcome",level:3}];function c(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"automating-dell-system-updates",children:"Automating Dell System Updates"}),"\n",(0,t.jsx)(n.p,{children:"Managing updates for Dell systems can be a time-consuming task, especially across multiple devices. To address this, I\u2019ve developed a PowerShell script that integrates Dell Command Update (DCU) with NinjaOne, automating the process from installation to execution. This post walks through what it does, how it works, and how you can deploy it in your environment."}),"\n",(0,t.jsx)(n.h3,{id:"purpose-and-features",children:"Purpose and Features"}),"\n",(0,t.jsx)(n.p,{children:"Dell Command Update is a powerful tool for keeping Dell systems current with the latest BIOS, firmware, drivers, and applications. My script takes it a step further by automating key operations within NinjaOne, an RMM platform I use extensively. Here\u2019s what it offers:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"System Validation"}),': Confirms the device is a Dell system and removes conflicting "Dell Update" applications that could interfere with DCU.']}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Dynamic Installation"}),": Downloads and installs the latest DCU version directly from Dell\u2019s support site, ensuring you\u2019re always up to date."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Customizable Scans"}),": Supports general scans for all updates or targeted BIOS/firmware scans, with results logged to NinjaOne custom fields (except for general scans, which output to CLI)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Flexible Updates"}),": Options to install all updates, exclude BIOS/firmware, or focus solely on BIOS/firmware, all triggered via a single NinjaOne variable."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"NinjaOne Integration"}),": Updates custom fields (",(0,t.jsx)(n.code,{children:"DCU1"})," for status, ",(0,t.jsx)(n.code,{children:"DCU2"})," for details) to streamline monitoring and reporting."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["The script is controlled through a NinjaOne dropdown variable named ",(0,t.jsx)(n.code,{children:"pleaseSelectAnOptionToRun"}),". You\u2019ll need to set this up with the following options:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Install"}),": Installs DCU after removing incompatible apps."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Remove Incompatible Versions"}),": Cleans up conflicting Dell Update software."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Run Scan"}),": Performs a full update scan, outputting results to the CLI."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Run BIOS and Firmware Scan"}),": Scans for BIOS/firmware updates, logging to NinjaOne fields."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Run Scan And Install All"}),": Scans and applies all available updates."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Run Scan And Install Excluding BIOS and Firmware"}),": Applies updates, skipping BIOS/firmware."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Run Scan And Install BIOS and Firmware ONLY"}),": Targets only BIOS/firmware updates."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"technical-overview",children:"Technical Overview"}),"\n",(0,t.jsx)(n.p,{children:"Here\u2019s a breakdown of the script\u2019s core functionality:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Pre-Installation Checks"}),": Scans the registry (",(0,t.jsx)(n.code,{children:"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall"}),") to uninstall incompatible Dell Update apps silently, ensuring a clean slate for DCU."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"DCU Download"}),": Uses ",(0,t.jsx)(n.code,{children:"Invoke-RestMethod"})," to scrape Dell\u2019s support page for the latest DCU ",(0,t.jsx)(n.code,{children:".exe"}),", then downloads it with ",(0,t.jsx)(n.code,{children:"Invoke-WebRequest"}),"\u2014no manual URL hunting required."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Execution Logic"}),": Leverages ",(0,t.jsx)(n.code,{children:"dcu-cli.exe"})," with tailored arguments (e.g., ",(0,t.jsx)(n.code,{children:"-silent"}),", ",(0,t.jsx)(n.code,{children:"-updateType"}),") to scan or apply updates. Exit codes are mapped to descriptive statuses in NinjaOne fields:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"0"}),": Updates available."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"500"}),": No updates found."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"1, 5"}),": Reboot required."]}),"\n",(0,t.jsxs)(n.li,{children:["Full mapping in the script\u2019s ",(0,t.jsx)(n.code,{children:"Handle-DCUExitCode"})," function."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Error Handling"}),": Wraps operations in try-catch blocks, logging failures to NinjaOne for easy troubleshooting."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The full script is available on my GitHub: ",(0,t.jsx)(n.a,{href:"https://github.com/Sp-e-n-c-er/Public-Ninja-One-Scripts/blob/main/Dell%20Command%20Update/Dell%20Command%20Update%20Automation%20Toolkit.ps1",children:"Public-Ninja-One-Scripts"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"benefits",children:"Benefits"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Efficiency"}),": Automates repetitive update tasks across Dell fleets."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Visibility"}),": Integrates with NinjaOne\u2019s custom fields for real-time status tracking."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Control"}),": Offers granular options to suit different update strategies."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Open Source"}),": Released under the MIT License\u2014free to use, modify, and distribute."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"deployment-steps",children:"Deployment Steps"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Download"}),": Grab the script from ",(0,t.jsx)(n.a,{href:"https://github.com/Sp-e-n-c-er/Public-Ninja-One-Scripts/blob/main/Dell%20Command%20Update/Dell%20Command%20Update%20Automation%20Toolkit.ps1",children:"GitHub"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Configure NinjaOne"}),": Add the ",(0,t.jsx)(n.code,{children:"pleaseSelectAnOptionToRun"})," dropdown with the listed options."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Run"}),": Deploy it via NinjaOne\u2019s script engine and monitor results in your custom fields."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"notes-and-disclaimer",children:"Notes and Disclaimer"}),"\n",(0,t.jsxs)(n.p,{children:["This script is provided under the MIT License\u2014use it freely, but at your own risk. I\u2019m not liable for any issues that arise; see the full license at ",(0,t.jsx)(n.a,{href:"https://opensource.org/licenses/MIT",children:"opensource.org/licenses/MIT"})," for details. It\u2019s been tested in my environment, but always validate in yours before going full throttle."]}),"\n",(0,t.jsx)(n.h3,{id:"feedback-welcome",children:"Feedback Welcome"}),"\n",(0,t.jsxs)(n.p,{children:["Have thoughts or suggestions? Reach out on ",(0,t.jsx)(n.a,{href:"https://github.com/Sp-e-n-c-er",children:"GitHub"})," or ",(0,t.jsx)(n.a,{href:"https://discordapp.com/users/286552274099240960",children:"Discord"}),". I\u2019m considering enhancements like automatic version checks or expanded error reporting\u2014let me know what you\u2019d like to see!"]}),"\n",(0,t.jsx)(n.p,{children:"Thanks for reading\u2014happy automating!"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Spencer Heath, 10 March 2025"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>r});var i=s(6540);const t={},l=i.createContext(t);function a(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(l.Provider,{value:n},e.children)}},8990:e=>{e.exports=JSON.parse('{"permalink":"/blog/dcu-automation-ninjaone","source":"@site/blog/2025-03-10-dcu-automation-ninjaone.md","title":"Streamlining Dell Updates with NinjaOne: A PowerShell Solution","description":"Automating Dell System Updates","date":"2025-03-10T00:00:00.000Z","tags":[{"inline":false,"label":"PowerShell","permalink":"/blog/tags/PowerShell","description":"Scripts and tools leveraging PowerShell for automation and system management"},{"inline":false,"label":"NinjaOne","permalink":"/blog/tags/NinjaOne","description":"Solutions integrating with NinjaOne for remote monitoring and management"},{"inline":false,"label":"Dell","permalink":"/blog/tags/Dell","description":"Tools and scripts tailored for Dell hardware and software management"},{"inline":false,"label":"Automation","permalink":"/blog/tags/Automation","description":"Resources focused on automating repetitive IT tasks and workflows"},{"inline":false,"label":"System Management","permalink":"/blog/tags/System_Management","description":"Scripts and utilities for managing and maintaining IT systems"}],"readingTime":3.105,"hasTruncateMarker":false,"authors":[{"name":"Spencer Heath","title":"Technical Security Engineer","url":"https://github.com/Sp-e-n-c-er","page":{"permalink":"/blog/authors/sheath"},"socials":{"github":"https://github.com/Sp-e-n-c-er"},"key":"sheath"}],"frontMatter":{"slug":"dcu-automation-ninjaone","title":"Streamlining Dell Updates with NinjaOne: A PowerShell Solution","authors":"sheath","tags":["powershell","ninjaone","dell","automation","system-management"],"date":"2025-03-10T00:00:00.000Z"},"unlisted":false,"nextItem":{"title":"Locking NinjaOne Systray scripts from users","permalink":"/blog/AdminLock-Script"}}')}}]);